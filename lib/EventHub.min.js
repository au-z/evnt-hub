!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("EventHub",[],n):"object"==typeof exports?exports.EventHub=n():e.EventHub=n()}(this,function(){return function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.default=function(e){function n(n){return!e.originRegex||!!e.originRegex.exec(n)}function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments[2];l.publish(e,n),r(e,n,t)}function r(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],i=(void 0===t?"undefined":o(t))===Object;r=r||u,a&&console.log("Attempting to postMessage "+n+". Payload: ",t),r?(s||console.warn("[EventHub] has no hubId."),i&&(t._hubId=s),r.postMessage({_type:n,payload:t},e.targetOrigin)):console.error("[EventHub] cannot postMessage to falsy window.")}function i(e){c=e}e=e||{},e.targetOrigin||console.error("[EventHub] targetOrigin not provided."),e.originRegex||console.warn("[EventHub] No originRegex provided. Incoming messages will not be checked.");var u=e.targetWindow||null,s=e.hubId||null,a=e.verbose||!1,c=function(){},l=function(e){function n(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};r[e]||(r[e]=[]);var t=(++i).toString();return r[e].push({token:t,func:n}),a&&console.log("Subscription to '"+e+"' added. Returning token: "+t+"."),t}function t(e,n){return a&&console.log("Event "+e+" published. Payload: ",n),!!r[e]&&(setTimeout(function(){for(var t=r[e],o=t?t.length:0;o--;)t[o].func(e,n);c()},0),!0)}function o(e){for(var n in r)if(r[n])for(var t=0;t<r[n].length;t++)if(r[n][t].token===e)return r[n].splice(t,1),e;return!1}var r={},i=-1;return{subscribe:n,publish:t,unsubscribe:o}}();return l.subscribe("_init_",function(e,n){s=n.toString()}),window.addEventListener("message",function(e){var t=e.origin||e.originalEvent.origin;if(!n(t))return void console.warn("[EventHub] message received from unknown origin. Ignoring.");e.data&&e.data._type&&e.data.payload&&(a&&console.log("PostMessage event "+e.data._type+" received from "+t+". Publishing."),l.publish(e.data._type,e.data.payload))}),{about:function(){return{hubId:s,originRegex:e.originRegex,targetOrigin:e.targetOrigin,targetWindow:u,verbose:a,version:"1.2.2"}},emit:t,nextTick:i,isOriginValid:n,publish:l.publish,subscribe:l.subscribe,unsubscribe:l.unsubscribe}},e.exports=n.default}])});